"0","# Accesses API and gets value for total rows in full race"
"0","laps_total.url <- paste0(""https://ergast.com/api/f1/"", YEAR, ""/"", ROUND, ""/laps.json"")"
"0","# Gets total number of rows in full race"
"0","total_num <- as.numeric(fromJSON(laps_total.url)$MRData$total)"
"0","# Number of loop iterations needed to access full race data (limit = 1000)"
"0","iterations_needed <- floor(total_num / 1000)"
"0",""
"0",""
"0","# Actual loop that gets full race data"
"0","laptimes_raw.df <- map_df(0 : iterations_needed, function(i){"
"0","  Sys.sleep(0.5)"
"0","  "
"0","  # Generate offset"
"0","  offset_x = i * 1000"
"0","  "
"0","  # Round 1"
"0","  r1_laptimes.url <- paste0(""https://ergast.com/api/f1/"", YEAR, ""/"", ROUND, ""/laps.json?limit=1000&offset="", offset_x)"
"0","  "
"0","  # get json from url, navigate json to lap times, then unnest "
"0","  r1_lap.df <- unnest(fromJSON(r1_laptimes.url)$MRData$RaceTable$Races$Laps[[1]], cols = c(Timings))"
"0","  "
"0","  return(r1_lap.df)"
"0","})"
"0",""
"0","head(laptimes_raw.df)"
